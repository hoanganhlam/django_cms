{"head":{"title":"Factory Bot","category":"Ruby libraries","layout":"2017/sheet","weight":-3,"updated":"2020-07-06T00:00:00.000Z","keywords":["FactoryBot.define do","factory :user","first_name 'John'","sequence(:username) { |n| \"user#{n}\" }"],"tags":["Featurable"]},"body":[{"title":null,"elms":"{: .-three-column}\n","h2":"Factories"},{"title":"Introduction","elms":"{: .-intro}\n\n[Factory Bot](http://www.rubydoc.info/gems/factory_bot/) is a helper for writing factories for Ruby tests. It was previously known as Factory Girl. For older versions, use `FactoryGirl` instead of `FactoryBot`.\n\n- [Factory Bot documentation](http://www.rubydoc.info/gems/factory_bot/) _(rubydoc.info)_\n- [Getting started](https://github.com/thoughtbot/factory_bot/blob/master/GETTING_STARTED.md) _(github.com)_\n- [Source code](https://github.com/thoughtbot/factory_bot) _(github.com)_\n","h2":"Factories"},{"title":"Defining factories","elms":"\n```ruby\nFactoryBot.define do\n  factory :user do\n    first_name { 'John' }\n    last_name  { 'Doe' }\n    birthdate  { 21.years.ago }\n    admin { false }\n\n    sequence(:username) { |n| \"user#{n}\" }\n  end\nend\n```\n{: data-line=\"2\"}\n\nSee: [Defining factories](http://www.rubydoc.info/gems/factory_bot/file/GETTING_STARTED.md#Defining_factories)\n","h2":"Factories"},{"title":"Extra options","elms":"\n#### Custom class names\n\n```ruby\nfactory :user, class: 'User' do\n  ···\nend\n```\n\n#### Aliases\n\n```ruby\nfactory :user, aliases: [:author] do\n  ···\nend\n```\n","h2":"Factories"},{"title":"Using","elms":"\n#### Build a model\n\n```ruby\nFactoryBot.build(:user)\n```\n\n#### Other ways\n\n```ruby\nbuild(:user)           # → model (not saved)\ncreate(:user)          # → model (saved)\nattributes_for(:user)  # → hash\nbuild_stubbed(:user)   # stubbed out attributes\n```\n\n#### With options\n\n```ruby\nbuild(:user, name: 'John')\n```\n\n#### Lists\n\n```ruby\ncreate_list(:user, 3)\nbuild_list(:user, 3)\n```\n","h2":"Factories"},{"title":"Defining","elms":"\n```ruby\nfactory :post do\n  association :author, factory: :user\n  association :author, factory: [:user, :admin]\nend\n```\n{: data-line=\"2,3\"}\n\n#### or\n\n```ruby\nfactory :post do\n  author  # assumes there's a factory :author\nend\n```\n","h2":"Associations"},{"title":"After-create hooks","elms":"\n```ruby\nfactory :post do\n  after :create do |post|\n    create :theme, post: post             # has_one\n    create_list :comment, 3, post: post   # has_many\n  end\nend\n```\n{: data-line=\"2\"}\n","h2":"Associations"},{"title":null,"elms":"{: .-three-column}\n","h2":"Other features"},{"title":"Traits","elms":"\n```ruby\nfactory :user do\n  trait :admin do\n    admin { true }\n  end\nend\n```\n{: data-line=\"2,3,4\"}\n\n```ruby\ncreate :user, :admin\n```\n\nTraits allow you to group attributes together.\nSee: [Traits](http://www.rubydoc.info/gems/factory_bot/file/GETTING_STARTED.md#Traits)\n","h2":"Other features"},{"title":"Nested factories","elms":"\n```ruby\nfactory :user do\n  first_name { 'John' }\n\n  factory :sample_user do\n    first_name { FFaker::Name.first_name }\n  end\nend\n```\n{: data-line=\"4,5,6\"}\n\n```ruby\ncreate :sample_user\n```\n\nSee: [Inheritance](http://www.rubydoc.info/gems/factory_bot/file/GETTING_STARTED.md#Inheritance)\n","h2":"Other features"},{"title":"Sub-factories","elms":"\n```ruby\nfactory :user do\n  ···\nend\n```\n\n```ruby\nfactory :sample_user, parent: :user do\n  first_name { FFaker::Name.first_name }\nend\n```\n{: data-line=\"1\"}\n\n```ruby\ncreate :sample_user\n```\n\nWorks the same as nested factories.\n","h2":"Other features"},{"title":"Options (transients)","elms":"\n```ruby\nfactory :user do\n  transient do\n    upcased { true }\n  end\n\n  after :create do |user, options|\n    user.name.upcase! if options.upcased\n  end\nend\n```\n{: data-line=\"2,3,4\"}\n\n```ruby\ncreate(user, upcased: true)\n```\n\nTransient attributes will not get passed to the model, but will be available in after-create hooks.\nSee: [Transient attributes](http://www.rubydoc.info/gems/factory_bot/file/GETTING_STARTED.md#Transient_Attributes)\n","h2":"Other features"},{"title":"Paths","elms":"\n* test/factories.rb\n* spec/factories.rb\n* test/factories/*.rb\n* spec/factories/*.rb\n\nPlace your factories in these locations.\n{: .-setup}\n","h2":"Other features"},{"title":null,"elms":"{: .-one-column}\n\n* <http://rubydoc.info/gems/factory_bot/file/GETTING_STARTED.md>","h2":"See also"}]}