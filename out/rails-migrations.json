{"head":{"title":"Migrations","category":"Rails"},"body":[{"title":"Automatically make migrations","elms":"\n    $ rails generate migration RemovePartNumberFromProducts part_number:string\n    $ rails generate migration remove_part_number_from_products part_number # rails assumes string if not type given - and you can use snake_case\n    \n    $ rails generate migration AddNameToWidgets name:string\n    $ rails g migration add_name_to_widgets name:string # you can use the short cut 'g' instead of generate - they both do the same thing\n","h2":null},{"title":"Run migrations","elms":"\n    $ rake db:migrate\n","h2":null},{"title":"Creating tables","elms":"\n    create_table :users do |t|\n      t.string :name\n      t.text   :description\n\n      t.primary_key :id\n      t.string      :title\n      t.text        :description\n      t.integer     :games_count\n      t.float       :lol\n      t.decimal     :price\n      t.decimal     :price, :precision => 2, :scale => 10\n      t.datetime    :expiration\n      t.timestamp   :time_in\n      t.time        :time_in\n      t.date        :expiry\n      t.binary      :image_data\n      t.boolean     :is_admin\n    end\n\n    # Options:\n      :null (boolean)\n      :limit (integer)\n      :default\n","h2":null},{"title":"Operations","elms":"\n    add_column    :users, :first_name, :string\n    remove_column :users, :first_name, :string\n\n    change_column :users, :first_name, :text\n\n    change_column_default :users, :admin, nil\n    change_column_null    :users, :email, false # adds NOT NULL constraint\n\n    create_table\n    change_table\n    drop_table\n\n    add_column\n    change_column\n    rename_column\n    remove_column\n\n    add_index\n    remove_index\n","h2":null},{"title":"Use models","elms":"\n    class AddFlagToProduct < ActiveRecord::Migration\n      class Product < ActiveRecord::Base\n      end\n     \n      def change\n        add_column :products, :flag, :boolean\n        Product.reset_column_information\n        reversible do |dir|\n          dir.up { Product.update_all flag: false }\n        end\n      end\n    end\n","h2":null},{"title":"Associations","elms":"    \n    t.references :category   # kinda same as t.integer :category_id\n\n    # Can have different types\n    t.references :category, polymorphic: true\n","h2":null},{"title":"Auto-Add/remove columns","elms":"  \n    $ rails generate migration RemovePartNumberFromProducts part_number:string\n","h2":null},{"title":"Indices","elms":"\n    # Simple\n    add_index :suppliers, :name\n\n    # Unique\n    add_index :accounts, [:branch_id, :party_id], :unique => true\n\n    # Named (:name => ...)\n    add_index :accounts, [:branch_id, :party_id], :unique => true, :name => \"by_branch_party\"\n\n    # Length\n    add_index :accounts, :name, :name => ‘by_name’, :length => 10\n    add_index :accounts, [:name, :surname], :name => ‘by_name_surname’,\n      :length => {\n        :name => 10,\n        :surname => 15\n      }\n\n    # Sort order (no MySQL support)\n    add_index :accounts, [:branch_id, :party_id, :surname],\n      :order => {:branch_id => :desc, :part_id => :asc}\n","h2":null},{"title":"In console","elms":"Use `ActiveRecord::Migration`.\n\n    ActiveRecord::Migration.add_index :posts, :slug\n","h2":null},{"title":"References","elms":"\n * http://apidock.com/rails/ActiveRecord/ConnectionAdapters/SchemaStatements/add_index","h2":null}]}