{"head":{"title":"MySQL","updated":"2020-07-05T00:00:00.000Z","layout":"2017/sheet","category":"Databases"},"body":[{"title":"Browsing","elms":"\n```sql\nSHOW DATABASES;\nSHOW TABLES;\nSHOW FIELDS FROM table / DESCRIBE table;\nSHOW CREATE TABLE table;\nSHOW PROCESSLIST;\nKILL process_number;\n```\n","h2":null},{"title":"Select","elms":"\n```sql\nSELECT * FROM table;\nSELECT * FROM table1, table2;\nSELECT field1, field2 FROM table1, table2;\nSELECT ... FROM ... WHERE condition\nSELECT ... FROM ... WHERE condition GROUPBY field;\nSELECT ... FROM ... WHERE condition GROUPBY field HAVING condition2;\nSELECT ... FROM ... WHERE condition ORDER BY field1, field2;\nSELECT ... FROM ... WHERE condition ORDER BY field1, field2 DESC;\nSELECT ... FROM ... WHERE condition LIMIT 10;\nSELECT DISTINCT field1 FROM ...\nSELECT DISTINCT field1, field2 FROM ...\n```\n","h2":null},{"title":"Select - Join","elms":"\n```sql\nSELECT ... FROM t1 JOIN t2 ON t1.id1 = t2.id2 WHERE condition;\nSELECT ... FROM t1 LEFT JOIN t2 ON t1.id1 = t2.id2 WHERE condition;\nSELECT ... FROM t1 JOIN (t2 JOIN t3 ON ...) ON ...\n```\n","h2":null},{"title":"Conditions","elms":"\n```sql\nfield1 = value1\nfield1 <> value1\nfield1 LIKE 'value _ %'\nfield1 IS NULL\nfield1 IS NOT NULL\nfield1 IS IN (value1, value2)\nfield1 IS NOT IN (value1, value2)\ncondition1 AND condition2\ncondition1 OR condition2\n```\n","h2":null},{"title":"Create / Open / Delete Database","elms":"\n```sql\nCREATE DATABASE DatabaseName;\nCREATE DATABASE DatabaseName CHARACTER SET utf8;\nUSE DatabaseName;\nDROP DATABASE DatabaseName;\nALTER DATABASE DatabaseName CHARACTER SET utf8;\n```\n","h2":null},{"title":"Backup Database to SQL File","elms":"\n```bash\nmysqldump -u Username -p dbNameYouWant > databasename_backup.sql\n```\n","h2":null},{"title":"Restore from backup SQL File","elms":"\n```bash\nmysql - u Username -p dbNameYouWant < databasename_backup.sql;\n```\n","h2":null},{"title":"Repair Tables After Unclean Shutdown","elms":"\n```bash\nmysqlcheck --all-databases;\nmysqlcheck --all-databases --fast;\n```\n","h2":null},{"title":"Insert","elms":"\n```sql\nINSERT INTO table1 (field1, field2) VALUES (value1, value2);\n```\n","h2":null},{"title":"Delete","elms":"\n```sql\nDELETE FROM table1 / TRUNCATE table1\nDELETE FROM table1 WHERE condition\nDELETE FROM table1, table2 FROM table1, table2 WHERE table1.id1 =\n  table2.id2 AND condition\n```\n","h2":null},{"title":"Update","elms":"\n```sql\nUPDATE table1 SET field1=new_value1 WHERE condition;\nUPDATE table1, table2 SET field1=new_value1, field2=new_value2, ... WHERE\n  table1.id1 = table2.id2 AND condition;\n```\n","h2":null},{"title":"Create / Delete / Modify Table","elms":"\n#### Create\n\n```sql\nCREATE TABLE table (field1 type1, field2 type2);\nCREATE TABLE table (field1 type1, field2 type2, INDEX (field));\nCREATE TABLE table (field1 type1, field2 type2, PRIMARY KEY (field1));\nCREATE TABLE table (field1 type1, field2 type2, PRIMARY KEY (field1,field2));\n```\n\n```sql\nCREATE TABLE table1 (fk_field1 type1, field2 type2, ...,\n  FOREIGN KEY (fk_field1) REFERENCES table2 (t2_fieldA))\n    [ON UPDATE|ON DELETE] [CASCADE|SET NULL]\n```\n\n```sql\nCREATE TABLE table1 (fk_field1 type1, fk_field2 type2, ...,\n FOREIGN KEY (fk_field1, fk_field2) REFERENCES table2 (t2_fieldA, t2_fieldB))\n```\n\n```sql\nCREATE TABLE table IF NOT EXISTS;\n```\n\n```sql\nCREATE TEMPORARY TABLE table;\n```\n\n#### Drop\n\n```sql\nDROP TABLE table;\nDROP TABLE IF EXISTS table;\nDROP TABLE table1, table2, ...\n```\n\n#### Alter\n\n```sql\nALTER TABLE table MODIFY field1 type1\nALTER TABLE table MODIFY field1 type1 NOT NULL ...\nALTER TABLE table CHANGE old_name_field1 new_name_field1 type1\nALTER TABLE table CHANGE old_name_field1 new_name_field1 type1 NOT NULL ...\nALTER TABLE table ALTER field1 SET DEFAULT ...\nALTER TABLE table ALTER field1 DROP DEFAULT\nALTER TABLE table ADD new_name_field1 type1\nALTER TABLE table ADD new_name_field1 type1 FIRST\nALTER TABLE table ADD new_name_field1 type1 AFTER another_field\nALTER TABLE table DROP field1\nALTER TABLE table ADD INDEX (field);\n```\n\n#### Change field order\n\n```sql\nALTER TABLE table MODIFY field1 type1 FIRST\nALTER TABLE table MODIFY field1 type1 AFTER another_field\nALTER TABLE table CHANGE old_name_field1 new_name_field1 type1 FIRST\nALTER TABLE table CHANGE old_name_field1 new_name_field1 type1 AFTER\n  another_field\n```\n","h2":null},{"title":"Keys","elms":"\n```sql\nCREATE TABLE table (..., PRIMARY KEY (field1, field2))\nCREATE TABLE table (..., FOREIGN KEY (field1, field2) REFERENCES table2\n(t2_field1, t2_field2))\n```\n","h2":null},{"title":"Users and Privileges","elms":"\n```sql\nCREATE USER 'user'@'localhost';\nGRANT ALL PRIVILEGES ON base.* TO 'user'@'localhost' IDENTIFIED BY 'password';\nGRANT SELECT, INSERT, DELETE ON base.* TO 'user'@'localhost' IDENTIFIED BY 'password';\nREVOKE ALL PRIVILEGES ON base.* FROM 'user'@'host'; -- one permission only\nREVOKE ALL PRIVILEGES, GRANT OPTION FROM 'user'@'host'; -- all permissions\nFLUSH PRIVILEGES;\n```\n\n```sql\nSET PASSWORD = PASSWORD('new_pass');\nSET PASSWORD FOR 'user'@'host' = PASSWORD('new_pass');\nSET PASSWORD = OLD_PASSWORD('new_pass');\n```\n\n```sql\nDROP USER 'user'@'host';\n```\n\nHost ‘%’ indicates any host.\n","h2":null},{"title":"Main Data Types","elms":"\n```sql\nTINYINT (1o: -217+128)\nSMALLINT (2o: +-65 000)\nMEDIUMINT (3o: +-16 000 000)\nINT (4o: +- 2 000 000 000)\nBIGINT (8o: +-9.10^18)\n```\n\n```sql\nPrecise interval: -(2^(8*N-1)) -> (2^8*N)-1\n```\n\n⚠ INT(2) = \"2 digits displayed\" -- NOT \"number with 2 digits max\"\n\n```sql\nFLOAT(M,D)\nDOUBLE(M,D)\nFLOAT(D=0->53)\n```\n\n⚠ 8,3 -> 12345,678 -- NOT 12345678,123!\n\n```sql\nTIME (HH:MM)\nYEAR (AAAA)\nDATE (AAAA-MM-JJ)\nDATETIME (AAAA-MM-JJ HH:MM; années 1000->9999)\nTIMESTAMP (like DATETIME, but 1970->2038, compatible with Unix)\n```\n\n```sql\nVARCHAR (single-line; explicit size)\nTEXT (multi-lines; max size=65535)\nBLOB (binary; max size=65535)\n```\n\nVariants for TEXT&BLOB: `TINY` (max=255), `MEDIUM` (max=~16000), and `LONG` (max=4Go). Ex: `VARCHAR(32)`, `TINYTEXT`, `LONGBLOB`, `MEDIUMTEXT`\n\n```sql\nENUM ('value1', 'value2', ...) -- (default NULL, or '' if NOT NULL)\n```\n","h2":null},{"title":"Reset Root Password","elms":"\n```bash\n$ /etc/init.d/mysql stop\n```\n\n```bash\n$ mysqld_safe --skip-grant-tables\n```\n\n```bash\n$ mysql # on another terminal\nmysql> UPDATE mysql.user SET password=PASSWORD('new_pass') WHERE user='root';\n```\n\n```bash","h2":null},{"title":null,"elms":"$ /etc/init.d/mysql start\n```\n\nYour commands may vary depending on your OS.","h2":"Switch back to the mysqld_safe terminal and kill the process using Control + \\"}]}