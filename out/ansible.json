{"head":{"title":"Ansible","category":"Ansible"},"body":[{"title":"Hosts","elms":"\n    $ sudo mkdir /etc/ansible\n    $ sudo vim /etc/ansible/hosts\n\n    [example]\n    192.0.2.101\n    192.0.2.102\n","h2":"Getting started"},{"title":"Running a playbook","elms":"\n    $ ansible-playbook playbook.yml\n","h2":"Getting started"},{"title":null,"elms":"\n    - hosts: all\n      user: root\n      sudo: no\n      vars:\n        aaa: bbb\n      tasks:\n        - ...\n      handlers:\n        - ...\n","h2":"Tasks"},{"title":"Includes","elms":"\n    tasks:\n      - include: db.yml\n    handlers:\n      - include: db.yml user=timmy\n","h2":"Tasks"},{"title":null,"elms":"\n    handlers:\n      - name: start apache2\n        action: service name=apache2 state=started\n\n    tasks:\n      - name: install apache\n        action: apt pkg=apache2 state=latest\n        notify:\n          - start apache2\n","h2":"Handlers"},{"title":null,"elms":"\n    - host: lol\n      vars_files:\n        - vars.yml\n      vars:\n        project_root: /etc/xyz\n      tasks:\n        - name: Create the SSH directory.\n          file: state=directory path=${project_root}/home/.ssh/\n          only_if: \"$vm == 0\"\n","h2":"Vars"},{"title":null,"elms":"\n    - host: xxx\n      roles:\n        - db\n        - { role:ruby, sudo_user:$user }\n        - web\n\n    # Uses:\n    # roles/db/tasks/*.yml\n    # roles/db/handlers/*.yml\n","h2":"Roles"},{"title":"Task: Failures","elms":"\n    - name: my task\n      command: ...\n      register: result\n      failed_when: \"'FAILED' in result.stderr\"\n\n      ignore_errors: yes\n\n      changed_when: \"result.rc != 2\"\n","h2":"Roles"},{"title":"Env vars","elms":"\n    vars:\n      local_home: \"{{ lookup('env','HOME') }}\"\n","h2":"Roles"},{"title":null,"elms":"\n  * [Intro](http://www.ansibleworks.com/docs/intro_configuration.html)\n  * [Modules](http://www.ansibleworks.com/docs/modules.html)\n\n{% endraw %}","h2":"References"}]}